<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLOps Take-Home Presentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/theme/black.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --r-background-color: #0c0c14;
            --r-main-font: 'Outfit', sans-serif;
            --r-heading-font: 'Outfit', sans-serif;
            --r-code-font: 'IBM Plex Mono', monospace;
            --r-main-color: #d4d4d8;
            --r-heading-color: #ffffff;
            --accent-warm: #f97316;
            --accent-blue: #38bdf8;
            --accent-purple: #a78bfa;
            --accent-green: #4ade80;
            --accent-red: #f87171;
        }
        
        .reveal {
            font-family: var(--r-main-font);
            font-weight: 400;
        }
        
        .reveal h1, .reveal h2, .reveal h3 {
            font-family: var(--r-heading-font);
            font-weight: 600;
            text-transform: none;
            letter-spacing: -0.03em;
        }
        
        .reveal h1 {
            font-size: 2.4em;
            background: linear-gradient(135deg, #f97316 0%, #fb923c 50%, #fbbf24 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .reveal h2 {
            font-size: 1.6em;
            color: #f97316;
            margin-bottom: 0.5em;
        }
        
        .reveal h3 {
            font-size: 1.05em;
            color: #fbbf24;
            margin-bottom: 0.4em;
        }
        
        .reveal .slides section {
            text-align: left;
            padding: 20px 40px;
            height: auto !important;
            max-height: 100%;
            overflow: visible;
        }
        
        .reveal .slides section.center-slide {
            text-align: center;
        }
        
        .reveal .slides {
            text-align: left;
        }
        
        .reveal p {
            line-height: 1.5;
            margin-bottom: 0.5em;
            font-size: 0.9em;
        }
        
        .reveal code {
            font-family: var(--r-code-font);
            background: rgba(249, 115, 22, 0.12);
            border: 1px solid rgba(249, 115, 22, 0.25);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            color: #fb923c;
        }
        
        .reveal pre {
            background: linear-gradient(145deg, #18181b 0%, #0f0f12 100%);
            border: 1px solid rgba(249, 115, 22, 0.2);
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            margin: 12px 0;
        }
        
        .reveal pre code {
            background: transparent;
            border: none;
            padding: 14px 18px;
            font-size: 0.55em;
            line-height: 1.5;
            color: #e4e4e7;
        }
        
        .callout {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.08) 0%, rgba(251, 191, 36, 0.08) 100%);
            border-left: 4px solid #f97316;
            padding: 12px 16px;
            border-radius: 0 10px 10px 0;
            margin: 16px 0;
            font-size: 0.85em;
        }
        
        .callout.insight {
            border-left-color: #38bdf8;
            background: linear-gradient(135deg, rgba(56, 189, 248, 0.08) 0%, rgba(96, 165, 250, 0.08) 100%);
        }
        
        .callout.warning {
            border-left-color: #f87171;
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.08) 0%, rgba(239, 68, 68, 0.08) 100%);
        }
        
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 12px;
        }
        
        .three-col {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            margin-top: 12px;
        }
        
        .card {
            background: linear-gradient(145deg, #1c1c22 0%, #141418 100%);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            padding: 16px;
        }
        
        .card h4 {
            color: #f97316;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .card p {
            color: #a1a1aa;
            font-size: 0.75em;
            margin: 0;
            line-height: 1.4;
        }
        
        .tag {
            display: inline-block;
            background: rgba(249, 115, 22, 0.15);
            border: 1px solid rgba(249, 115, 22, 0.3);
            color: #fb923c;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.7em;
            font-weight: 500;
            margin: 3px;
        }
        
        .tag.blue { background: rgba(56, 189, 248, 0.15); border-color: rgba(56, 189, 248, 0.3); color: #38bdf8; }
        .tag.purple { background: rgba(167, 139, 250, 0.15); border-color: rgba(167, 139, 250, 0.3); color: #a78bfa; }
        .tag.green { background: rgba(74, 222, 128, 0.15); border-color: rgba(74, 222, 128, 0.3); color: #4ade80; }
        
        .big-number {
            font-size: 2.8em;
            font-weight: 700;
            background: linear-gradient(135deg, #f97316 0%, #fbbf24 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }
        
        .stat-label {
            color: #71717a;
            font-size: 0.7em;
            margin-top: 2px;
        }
        
        .subtle {
            color: #71717a;
            font-size: 0.9em;
        }
        
        .emphasis {
            color: #fbbf24;
            font-weight: 500;
        }
        
        .diagram {
            background: #18181b;
            border: 2px dashed rgba(249, 115, 22, 0.3);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            margin: 8px 0;
            font-size: 0.85em;
        }
        
        .diagram.bronze { border-color: #cd7f32; }
        .diagram.silver { border-color: #94a3b8; }
        .diagram.gold { border-color: #fbbf24; }
        
        .flow-arrow {
            color: #f97316;
            font-size: 1.2em;
            margin: 4px 0;
            line-height: 1;
        }
        
        ul.clean {
            list-style: none;
            padding-left: 0;
            margin: 0;
        }
        
        ul.clean li {
            padding: 4px 0;
            padding-left: 24px;
            position: relative;
            font-size: 0.85em;
        }
        
        ul.clean li::before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #f97316;
        }
        
        .speaker-note {
            background: rgba(56, 189, 248, 0.05);
            border: 1px dashed rgba(56, 189, 248, 0.3);
            border-radius: 8px;
            padding: 12px 16px;
            font-size: 0.75em;
            color: #71717a;
            margin-top: 20px;
            font-style: italic;
        }
        
        .title-slide {
            text-align: center !important;
        }
        
        .title-slide h1 {
            font-size: 2.6em;
            margin-bottom: 0.3em;
        }
        
        .title-slide .subtitle {
            font-size: 1.2em;
            color: #a1a1aa;
            font-weight: 300;
            margin-bottom: 1em;
        }
        
        table.schema {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.6em;
            margin-top: 10px;
        }
        
        table.schema th {
            background: rgba(249, 115, 22, 0.15);
            padding: 6px 8px;
            text-align: left;
            color: #f97316;
            font-weight: 500;
        }
        
        table.schema td {
            padding: 4px 8px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            color: #a1a1aa;
        }
        
        .quote {
            font-size: 1.1em;
            font-style: italic;
            color: #d4d4d8;
            border-left: 3px solid #f97316;
            padding-left: 20px;
            margin: 16px 0;
        }
        
        .timeline {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            position: relative;
        }
        
        .timeline::before {
            content: "";
            position: absolute;
            top: 14px;
            left: 5%;
            right: 5%;
            height: 2px;
            background: linear-gradient(90deg, #f97316, #fbbf24, #4ade80);
            border-radius: 2px;
        }
        
        .timeline-point {
            text-align: center;
            z-index: 1;
        }
        
        .timeline-dot {
            width: 28px;
            height: 28px;
            background: #18181b;
            border: 2px solid #f97316;
            border-radius: 50%;
            margin: 0 auto 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65em;
            font-weight: 600;
        }
        
        .timeline-label {
            font-size: 0.55em;
            color: #a1a1aa;
            max-width: 70px;
        }
    </style>
</head>
<body>
    <div class="reveal">
        <div class="slides">
            
            <!-- Slide 1: Title -->
            <section class="title-slide center-slide">
                <h1>Building a Fraud Detection Pipeline</h1>
                <p class="subtitle">From Messy Data to ML-Ready Features</p>
                <div style="margin-top: 50px;">
                    <span class="tag">Payment Data</span>
                    <span class="tag blue">Data Engineering</span>
                    <span class="tag purple">MLOps</span>
                </div>
                <p class="subtle" style="margin-top: 40px;">15 minute walkthrough</p>
            </section>

            <!-- Slide 2: Setting the Scene -->
            <section>
                <h2>Let me set the scene</h2>
                <p>You're a data engineer at a payment company. Your fraud team keeps asking:</p>
                <p class="quote">"Can you just give us one table with everything we need?"</p>
                <p>Sounds simple, right? Except...</p>
                <ul class="clean">
                    <li>Payment data streams in real-time from an API</li>
                    <li>Account info arrives daily in a CSV dump</li>
                    <li>Risk scores show up... whenever the vendor feels like it</li>
                    <li>Fraud labels? Those take 30-60 days to confirm</li>
                </ul>
                <div class="callout">
                    <strong>The real challenge:</strong> These four systems don't talk to each other, they're on different schedules, and upstream teams change schemas without telling you.
                </div>
            </section>

            <!-- Slide 3: What We're Building -->
            <section>
                <h2>What we're actually building</h2>
                <p>A <span class="emphasis">unified payment intelligence table</span> that:</p>
                <div class="two-col">
                    <div>
                        <h3>For ML Training</h3>
                        <ul class="clean">
                            <li>One row per payment transaction</li>
                            <li>All context joined in (accounts, risk, fraud labels)</li>
                            <li>Point-in-time correct (no data leakage)</li>
                            <li>Refreshes daily, automatically</li>
                        </ul>
                    </div>
                    <div>
                        <h3>For Operations</h3>
                        <ul class="clean">
                            <li>Handles upstream failures gracefully</li>
                            <li>Alerts when data quality degrades</li>
                            <li>Doesn't break when schemas change</li>
                            <li>Can be run by 1-2 people, not a team of 10</li>
                        </ul>
                    </div>
                </div>
                <p class="subtle" style="margin-top: 20px;">I'll show you the architecture (Task 1) and then the actual Python implementation (Task 2).</p>
            </section>

            <!-- Slide 4: The Four Data Sources - Deep Dive -->
            <section>
                <h2>Understanding our data sources</h2>
                <p>Each source has its own personality. Let's meet them:</p>
                <div class="three-col">
                    <div class="card">
                        <h4>‚ö° Payments API</h4>
                        <p>Real-time stream, ~1000 txns/hour. This is our fact table - if a payment isn't here, it didn't happen.</p>
                        <p style="margin-top: 10px;"><code>payment_id</code>, <code>amount</code>, <code>timestamp</code></p>
                    </div>
                    <div class="card">
                        <h4>üìÅ Account CSV</h4>
                        <p>Daily dump at 6 AM. Contains opening dates - critical for features like "account age at transaction time."</p>
                        <p style="margin-top: 10px;"><code>account_id</code>, <code>opening_date</code></p>
                    </div>
                    <div class="card">
                        <h4>üö® Risk Feed</h4>
                        <p>Irregular batches from external vendor. Sometimes 3x/day, sometimes nothing for a week. Fun times.</p>
                        <p style="margin-top: 10px;"><code>account_id</code>, <code>risk_flag</code></p>
                    </div>
                </div>
            </section>

            <!-- Slide 5: The Delayed Labels Problem -->
            <section>
                <h2>The delayed labels problem</h2>
                <p>Our fourth data source is the trickiest: <span class="emphasis">fraud confirmations</span>.</p>
                <div class="callout warning">
                    <strong>Here's the catch:</strong> When a payment happens, we don't know if it's fraud. We find out 30-60 days later when the customer disputes it, or investigators confirm it.
                </div>
                <p>This creates a nasty ML problem called <strong>data leakage</strong>:</p>
                <p class="subtle">If you train a model on Monday using fraud labels that weren't actually available until Wednesday, your model is "cheating" - it has future information.</p>
                
                <div class="callout insight">
                    <strong>Our solution:</strong> We track <code>fraud_reported_date</code> separately. When generating training data, we only join labels that existed at prediction time. The unified table preserves both timestamps.
                </div>
            </section>

            <!-- Slide 6: Why Medallion Architecture -->
            <section>
                <h2>Why I chose medallion architecture</h2>
                <p>You might be thinking: "Why not just stream everything through Kafka and Flink?"</p>
                <p>Here's my honest take:</p>
                <div class="two-col">
                    <div>
                        <h3 style="color: #f87171;">The streaming-first dream</h3>
                        <ul class="clean">
                            <li>Looks great in architecture diagrams</li>
                            <li>Real-time everything!</li>
                            <li>Requires 5+ engineers to operate</li>
                            <li>Debugging distributed state is painful</li>
                        </ul>
                    </div>
                    <div>
                        <h3 style="color: #4ade80;">The medallion reality</h3>
                        <ul class="clean">
                            <li>Batch is easier to debug</li>
                            <li>15-minute latency is fine for fraud</li>
                            <li>1-2 people can run it</li>
                            <li>Built-in audit trail (Bronze layer)</li>
                        </ul>
                    </div>
                </div>
                <p class="subtle" style="margin-top: 20px;">Real-time is Month 7+ if the business actually needs sub-minute latency. They usually don't.</p>
            </section>

            <!-- Slide 7: The Three Layers -->
            <section>
                <h2>Three layers, three purposes</h2>
                <div style="display: flex; flex-direction: column; gap: 16px;">
                    <div class="diagram bronze">
                        <strong style="color: #cd7f32;">Bronze ‚Äî Raw Storage</strong><br>
                        <span class="subtle">Dump everything here. Don't transform. Don't filter. If upstream breaks, we still have the data.</span><br>
                        <span class="tag">Parquet files</span> <span class="tag">Partitioned by date</span> <span class="tag">Immutable</span>
                    </div>
                    <div class="flow-arrow">‚Üì</div>
                    <div class="diagram silver">
                        <strong style="color: #94a3b8;">Silver ‚Äî Cleaned & Validated</strong><br>
                        <span class="subtle">Deduplicate, coerce types, validate business rules. Bad records go to dead letter queue.</span><br>
                        <span class="tag blue">Great Expectations</span> <span class="tag blue">Type coercion</span> <span class="tag blue">Referential checks</span>
                    </div>
                    <div class="flow-arrow">‚Üì</div>
                    <div class="diagram gold">
                        <strong style="color: #fbbf24;">Gold ‚Äî ML-Ready Features</strong><br>
                        <span class="subtle">Join everything. Compute derived features. This is what data scientists query.</span><br>
                        <span class="tag green">Unified table</span> <span class="tag green">Point-in-time correct</span> <span class="tag green">Daily refresh</span>
                    </div>
                </div>
            </section>

            <!-- Slide 8: The Unified Table Schema -->
            <section>
                <h2>The actual schema</h2>
                <p>Here's what the Gold layer unified table looks like. 13 columns, denormalized for fast ML queries:</p>
                <table class="schema">
                    <tr><th>Column</th><th>Type</th><th>Source</th><th>Why it matters</th></tr>
                    <tr><td><code>payment_id</code></td><td>STRING</td><td>Payments</td><td>Primary key</td></tr>
                    <tr><td><code>src_account_id</code></td><td>STRING</td><td>Payments</td><td>Who sent money</td></tr>
                    <tr><td><code>dest_account_id</code></td><td>STRING</td><td>Payments</td><td>Who received it</td></tr>
                    <tr><td><code>amount</code></td><td>DECIMAL</td><td>Payments</td><td>Transaction value</td></tr>
                    <tr><td><code>timestamp</code></td><td>TIMESTAMP</td><td>Payments</td><td>When it happened</td></tr>
                    <tr><td><code>src_opening_date</code></td><td>DATE</td><td>Accounts</td><td>For "account age" features</td></tr>
                    <tr><td><code>dest_opening_date</code></td><td>DATE</td><td>Accounts</td><td>New accounts = higher risk</td></tr>
                    <tr><td><code>src_risk_flag</code></td><td>INT</td><td>Risk Feed</td><td>External risk signal (0-5)</td></tr>
                    <tr><td><code>dest_risk_flag</code></td><td>INT</td><td>Risk Feed</td><td>Receiver risk profile</td></tr>
                    <tr><td><code>fraud_flag</code></td><td>BOOLEAN</td><td>Fraud Labels</td><td>The target variable</td></tr>
                    <tr><td><code>fraud_type</code></td><td>STRING</td><td>Fraud Labels</td><td>Classification of fraud</td></tr>
                </table>
            </section>

            <!-- Slide 9: Join Strategy -->
            <section>
                <h2>The join strategy (this is important)</h2>
                <p>We use <span class="emphasis">LEFT JOINs everywhere</span>. Here's why:</p>
                <pre><code>SELECT p.*, 
       src_acc.opening_date AS src_opening_date,
       dest_acc.opening_date AS dest_opening_date,
       src_risk.risk_flag AS src_risk_flag,
       dest_risk.risk_flag AS dest_risk_flag,
       fraud.fraud_flag, fraud.fraud_type
FROM payments p
  LEFT JOIN accounts src_acc ON p.src_account_id = src_acc.account_id
  LEFT JOIN accounts dest_acc ON p.dest_account_id = dest_acc.account_id  
  LEFT JOIN risk_feed src_risk ON p.src_account_id = src_risk.account_id
  LEFT JOIN risk_feed dest_risk ON p.dest_account_id = dest_risk.account_id
  LEFT JOIN fraud_labels fraud ON p.payment_id = fraud.payment_id</code></pre>
                <div class="callout insight">
                    <strong>Why LEFT JOIN?</strong> A payment is still a payment even if we're missing account data. INNER JOIN would silently drop records - that's how you end up with "where did my transactions go?" bugs at 3 AM.
                </div>
            </section>

            <!-- Slide 10: Data Quality - Three Layers -->
            <section>
                <h2>Data quality: defense in depth</h2>
                <p>I don't trust upstream systems. Here's how we validate at each layer:</p>
                <div class="three-col">
                    <div class="card">
                        <h4 style="color: #cd7f32;">Bronze Checks</h4>
                        <p><strong>Goal:</strong> Did we receive data?</p>
                        <ul class="clean" style="font-size: 0.8em;">
                            <li>Schema matches expected</li>
                            <li>Row count > 0</li>
                            <li>No total file corruption</li>
                        </ul>
                        <p class="subtle">If this fails, alert immediately but don't block the pipeline.</p>
                    </div>
                    <div class="card">
                        <h4 style="color: #94a3b8;">Silver Checks</h4>
                        <p><strong>Goal:</strong> Is the data sane?</p>
                        <ul class="clean" style="font-size: 0.8em;">
                            <li>payment_id is unique</li>
                            <li>amount > 0</li>
                            <li>>95% accounts exist</li>
                        </ul>
                        <p class="subtle">Bad records ‚Üí dead letter queue for investigation.</p>
                    </div>
                    <div class="card">
                        <h4 style="color: #fbbf24;">Gold Checks</h4>
                        <p><strong>Goal:</strong> Is ML quality okay?</p>
                        <ul class="clean" style="font-size: 0.8em;">
                            <li>Fraud rate within expected range</li>
                            <li>Feature distributions stable</li>
                            <li>No NULLs in critical fields</li>
                        </ul>
                        <p class="subtle">Drift alerts ‚Üí data science reviews.</p>
                    </div>
                </div>
            </section>

            <!-- Slide 11: Monitoring -->
            <section>
                <h2>Monitoring: what I actually track</h2>
                <p>Prometheus + Grafana. Here are the metrics that matter:</p>
                <div class="two-col">
                    <div>
                        <h3>Pipeline Health</h3>
                        <ul class="clean">
                            <li><code>pipeline_last_success_time</code> ‚Äî is it running?</li>
                            <li><code>bronze_row_count</code> ‚Äî did we get data?</li>
                            <li><code>silver_validation_pass_rate</code> ‚Äî quality signal</li>
                            <li><code>gold_freshness_hours</code> ‚Äî how stale is the table?</li>
                        </ul>
                    </div>
                    <div>
                        <h3>Alert Tiers</h3>
                        <ul class="clean">
                            <li><span style="color: #f87171;">P1:</span> Pipeline hasn't run in 4 hours</li>
                            <li><span style="color: #f97316;">P2:</span> Validation rate < 90%</li>
                            <li><span style="color: #fbbf24;">P3:</span> Schema change detected</li>
                            <li><span style="color: #71717a;">Info:</span> Daily summary email</li>
                        </ul>
                    </div>
                </div>
                <div class="callout">
                    <strong>Schema fingerprinting:</strong> We hash column names + types. If the hash changes, something upstream changed without telling us. Automatic alert before the pipeline breaks.
                </div>
            </section>

            <!-- Slide 12: Implementation Timeline -->
            <section>
                <h2>Realistic 6-month plan</h2>
                <p>Here's how I'd actually roll this out with a small team:</p>
                <div class="timeline">
                    <div class="timeline-point">
                        <div class="timeline-dot">1-2</div>
                        <div class="timeline-label">Infra setup<br>Airflow, S3, basic DAGs</div>
                    </div>
                    <div class="timeline-point">
                        <div class="timeline-dot">3-4</div>
                        <div class="timeline-label">Bronze layer<br>All sources landing</div>
                    </div>
                    <div class="timeline-point">
                        <div class="timeline-dot">5-8</div>
                        <div class="timeline-label">Silver + Gold<br>Unified table works</div>
                    </div>
                    <div class="timeline-point">
                        <div class="timeline-dot">9-16</div>
                        <div class="timeline-label">Quality layer<br>Validation, alerts</div>
                    </div>
                    <div class="timeline-point">
                        <div class="timeline-dot">17-24</div>
                        <div class="timeline-label">Polish<br>Docs, handoff</div>
                    </div>
                </div>
                <div class="callout insight">
                    <strong>Key milestone:</strong> Data scientists can query the unified table by Week 8. Everything after that is making it production-grade and reliable.
                </div>
            </section>

            <!-- Slide 13: Tech Stack -->
            <section>
                <h2>Technology choices</h2>
                <p>I'm optimizing for <span class="emphasis">"can 1-2 people actually run this"</span>, not resume-driven development.</p>
                <div class="two-col">
                    <div>
                        <h3 style="color: #4ade80;">Use now</h3>
                        <p><span class="tag green">Airflow</span> Orchestration - boring but reliable</p>
                        <p><span class="tag green">Spark</span> Processing - handles scale when needed</p>
                        <p><span class="tag green">Parquet</span> Storage - columnar, efficient, readable</p>
                        <p><span class="tag green">Great Expectations</span> Quality - Python-native validation</p>
                        <p><span class="tag green">Prometheus/Grafana</span> Monitoring - industry standard</p>
                    </div>
                    <div>
                        <h3 style="color: #71717a;">Skip for now</h3>
                        <p><span class="tag" style="opacity: 0.5;">Kafka</span> Overkill for our volume</p>
                        <p><span class="tag" style="opacity: 0.5;">Flink</span> Complex operational burden</p>
                        <p><span class="tag" style="opacity: 0.5;">Feast</span> We don't need a feature store yet</p>
                        <p><span class="tag" style="opacity: 0.5;">Delta Lake</span> Parquet is fine for now</p>
                        <p class="subtle" style="margin-top: 16px;">These are Month 7+ decisions if volume 10x's.</p>
                    </div>
                </div>
            </section>

            <!-- Slide 14: Task 2 Intro -->
            <section class="center-slide">
                <h1 style="font-size: 2.5em;">Now let me show you the code</h1>
                <p class="subtitle" style="color: #a1a1aa;">Task 2: Python Implementation</p>
            </section>

            <!-- Slide 15: Two Implementations -->
            <section>
                <h2>I built two versions</h2>
                <div class="two-col">
                    <div class="card">
                        <h4>üì¶ consolidate_payments.py</h4>
                        <p>The straightforward batch version. Reads CSVs, joins everything, outputs unified table.</p>
                        <p style="margin-top: 12px;"><strong>~200 lines</strong> of clean, modular Python</p>
                        <p class="subtle">This is what you'd run in production with Airflow.</p>
                    </div>
                    <div class="card">
                        <h4>üåä consolidate_payments_streaming.py</h4>
                        <p>Simulates streaming ingestion with generators, stateful buffers, and micro-batching.</p>
                        <p style="margin-top: 12px;"><strong>~350 lines</strong> showing real-world patterns</p>
                        <p class="subtle">Demonstrates how this would work with real APIs.</p>
                    </div>
                </div>
                <div class="callout">
                    <strong>Key point:</strong> Both produce identical output. The streaming version is more complex but shows how you'd handle real-time data without a full Kafka setup.
                </div>
            </section>

            <!-- Slide 16: Code Architecture -->
            <section>
                <h2>How the code is structured</h2>
                <p>One class, clear separation of concerns:</p>
                <pre><code>class PaymentDataConsolidator:
    def __init__(self, data_dir="data"):
        """Point me at the data directory, I'll handle the rest."""
        
    def load_payment_transactions(self) -> pd.DataFrame
    def load_account_details(self) -> pd.DataFrame  
    def load_risk_feed(self) -> pd.DataFrame
    def load_fraud_cases(self) -> pd.DataFrame
    
    def consolidate(self) -> pd.DataFrame  # The magic happens here
    def save_unified_table(self, df, output_path)
    
    def run_pipeline(self) -> pd.DataFrame  # Entry point</code></pre>
                <p style="margin-top: 16px;">Each loader handles its own validation and edge cases. <code>consolidate()</code> does the joins and applies defaults. Simple.</p>
            </section>

            <!-- Slide 17: Handling Edge Cases -->
            <section>
                <h2>Edge cases I handled</h2>
                <p>The devil's in the details. Here's what the code deals with:</p>
                <div class="two-col">
                    <div>
                        <h3>Missing data</h3>
                        <ul class="clean">
                            <li>Account not found ‚Üí <code>opening_date = NULL</code></li>
                            <li>No risk score ‚Üí <code>risk_flag = 0</code> (assume clean)</li>
                            <li>No fraud label ‚Üí <code>fraud_flag = False</code> (not confirmed fraud)</li>
                        </ul>
                    </div>
                    <div>
                        <h3>Data quality</h3>
                        <ul class="clean">
                            <li>Duplicate payment IDs ‚Üí dedupe on load</li>
                            <li>Multiple risk flags per account ‚Üí take most recent</li>
                            <li>Invalid amounts ‚Üí log warning, keep record</li>
                        </ul>
                    </div>
                </div>
                <div class="callout insight">
                    <strong>Philosophy:</strong> Log everything, drop nothing. Better to have a suspicious record in the output than silently lose data.
                </div>
            </section>

            <!-- Slide 18: Results -->
            <section>
                <h2>Results from the test data</h2>
                <p>Ran both scripts against the sample dataset:</p>
                <div class="three-col" style="text-align: center;">
                    <div>
                        <div class="big-number">15</div>
                        <div class="stat-label">Transactions processed</div>
                    </div>
                    <div>
                        <div class="big-number">4</div>
                        <div class="stat-label">Fraud cases identified</div>
                    </div>
                    <div>
                        <div class="big-number">100%</div>
                        <div class="stat-label">Join success rate</div>
                    </div>
                </div>
                <div class="callout" style="margin-top: 30px;">
                    <strong>Pattern found:</strong> All 4 fraud cases involved accounts with elevated risk flags (ACC105, ACC108) sending large amounts to newly-opened destination accounts. Exactly what you'd expect.
                </div>
            </section>

            <!-- Slide 19: Sample Output -->
            <section>
                <h2>What the output looks like</h2>
                <pre><code style="font-size: 0.55em;">payment_id | src_account | dest_account | amount    | src_risk | fraud_flag | fraud_type
-----------+-------------+--------------+-----------+----------+------------+------------------------
PAY001     | ACC101      | ACC201       | 150.50    | 0        | False      | 
PAY006     | ACC105      | ACC205       | 10000.00  | 4        | True       | authorized_push_payment
PAY008     | ACC108      | ACC201       | 8500.00   | 3        | True       | account_takeover
PAY015     | ACC105      | ACC212       | 12500.00  | 4        | True       | authorized_push_payment</code></pre>
                <p>Clean, denormalized, ready for ML. Data scientist can <code>SELECT * FROM unified_table</code> and start training immediately.</p>
                <p class="subtle">All 13 columns present. Point-in-time correct. Defaults applied where needed.</p>
            </section>

            <!-- Slide 20: Key Takeaways -->
            <section>
                <h2>What I want you to remember</h2>
                <div style="font-size: 1.1em; line-height: 1.8;">
                    <p><span style="color: #f97316; font-weight: 600;">1.</span> <strong>Defensive design beats clever design.</strong> Bronze layer means you can recover from upstream disasters.</p>
                    <p><span style="color: #f97316; font-weight: 600;">2.</span> <strong>Point-in-time correctness is non-negotiable.</strong> ML models that cheat with future data will fail in production.</p>
                    <p><span style="color: #f97316; font-weight: 600;">3.</span> <strong>Right-size your tech stack.</strong> Kafka is cool. Running Kafka with 2 people is not cool.</p>
                    <p><span style="color: #f97316; font-weight: 600;">4.</span> <strong>Ship early, iterate.</strong> Data scientists querying by Month 2 beats "perfect architecture" by Month 12.</p>
                </div>
            </section>

            <!-- Slide 21: Questions -->
            <section class="center-slide">
                <h1>Questions?</h1>
                <p class="subtitle" style="color: #a1a1aa; margin-top: 30px;">Happy to dive deeper into any section</p>
                <div style="margin-top: 60px;">
                    <span class="tag blue">Code: github.com/Sam-Udo/mlops-take-home</span>
                </div>
                <p class="subtle" style="margin-top: 40px;">Thanks for your time</p>
            </section>

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            slideNumber: 'c/t',
            transition: 'slide',
            transitionSpeed: 'default',
            backgroundTransition: 'fade',
            center: true,
            progress: true,
            controls: true,
            controlsTutorial: false,
            width: 1100,
            height: 700,
            margin: 0.15,
            minScale: 0.2,
            maxScale: 1.5
        });
    </script>
</body>
</html>
